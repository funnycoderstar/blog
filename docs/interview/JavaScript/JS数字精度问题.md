## JavaScript 中精度问题以及解决方案

1. 小数加法

```js
0.1 + 0.2 = 0.30000000000000004;
```

2. 大数精度问题，比如 9999 9999 9999 9999 == 1000 0000 0000 0000 1

3. toFixed 四舍五入结果不准确，比如 1.335.toFixed(2) == 1.33

浮点数精度和 toFixed 其实属于同一类问题，都是由于浮点数无法精确表示引起的，如下：

## 原因

在计算机角度，计算机算的是二进制，而不是十进制。二进制后变成了无线不循环的数，而计算机可支持浮点数的小数部分可支持到 52 位，所有两者相加，在转换成十进制，得到的数就不准确了，

## 解法

1. 可以对结果进行指定精度的四舍五入
   通过 toFixed(num) 方法来保留小数。因为这个方法是根据四舍五入来保留小数的，所以最后的计算结果不精确。

```js
(1.35).toFixed(1); // 1.4 正确
(1.335).toFixed(2); // 1.33  错误
(1.3335).toFixed(3); // 1.333 错误
(1.33335).toFixed(4); // 1.3334 正确
(1.333335).toFixed(5); // 1.33333 错误
(1.3333335).toFixed(6); // 1.333333 错误
```

toFixed()方法可把 Number 四舍五入为指定小数位数的数字。

2. 将浮点数转为整数运算，再对结果做除法。比如 0.1 + 0.2，可以转化为`(1*2)/10`。
3. 把浮点数转化为字符串，模拟实际运算的过程

### 三方库

-   [number-precision](https://github.com/nefe/number-precision)
-   [bignumber](https://github.com/MikeMcl/bignumber.js)
-   [decimal](https://github.com/MikeMcl/decimal.js)
-   [big](https://github.com/MikeMcl/big.js)
